{% extends 'base.html' %}
{% block content %}
<div class="chat-card">
  <div class="card">
    <div class="card-body">
      <h1 class="h4">{{ assistant.name }}</h1>
      <form method="post" class="mb-3 mt-3">
          <div class="mb-3">
              <textarea name="prompt" class="form-control" rows="3" placeholder="Сообщение"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Отправить</button>
      </form>
      <form action="{{ url_for('reset_assistant_thread', assistant_id=assistant.id) }}" method="post" class="mb-3">
          <button type="submit" class="btn btn-warning">Очистить диалог</button>
      </form>
      <div id="messages" class="d-flex flex-column gap-2 mb-3 messages">
      {% for m in messages %}
          <div class="d-flex {% if m.role == 'assistant' %}justify-content-end{% endif %}">
              <div class="message {{ 'assistant' if m.role == 'assistant' else 'user' }} animate__animated animate__fadeIn">
                  {{ m.content[0].text.value if m.content else '' }}
              </div>
          </div>
      {% endfor %}
      </div>
      <a href="{{ url_for('list_assistants') }}" class="btn btn-secondary">Назад</a>
    </div>
  </div>
</div>
{% endblock %}
